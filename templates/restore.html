{% extends "base.html" %}

{% block content %}
<!-- Breadcrumb Navigation -->
<div class="bg-white shadow-md rounded p-4 mb-6">
    <nav class="flex" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a href="/" class="text-blue-600 hover:text-blue-800 font-medium">Dashboard</a>
            </li>
            <li>
                <div class="flex items-center">
                    <span class="mx-2 text-gray-400">/</span>
                    <a href="/files" class="text-blue-600 hover:text-blue-800 font-medium">Files</a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <span class="mx-2 text-gray-400">/</span>
                    <span class="text-gray-500 font-medium">Restore</span>
                </div>
            </li>
        </ol>
    </nav>
</div>



<!-- File Information -->
<div class="bg-white shadow-md rounded p-6 mb-6">
    <h3 class="text-lg font-semibold text-gray-800 mb-4">File Information</h3>

    <div class="text-gray-800 bg-gray-50 p-4 rounded text-left">
        <p class="mb-2">
            <span class="font-medium text-gray-600">File Path:</span> {{ backup.file_path }}
        </p>
        <p class="mb-2">
            <span class="font-medium text-gray-600">Backup Date:</span> {{ backup.backup_date | format_datetime | safe
            }}
        </p>
        <p class="mb-2">
            <span class="font-medium text-gray-600">File Size:</span> {{ "%.1f"|format((backup.encrypted_size or 0) /
            1024) }} KB
        </p>
        <p class="mb-0">
            <span class="font-medium text-gray-600">Version:</span> v{{ backup.version }}
        </p>
    </div>
</div>

<!-- Restore Form -->
<div class="bg-white shadow-md rounded p-6 mb-6">
    <h3 class="text-lg font-semibold text-gray-800 mb-4">Restore Options</h3>

    <form method="POST" class="space-y-4">
        <div>
            <label for="restore_path" class="block text-sm font-medium text-gray-600 mb-2">Restore to Path</label>
            <input type="text" id="restore_path" name="restore_path" value="{{ backup.file_path|e }}" required
                class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 font-mono text-sm">
            <p class="text-sm text-gray-500 mt-1">Specify where to restore the file. Leave as original path to
                overwrite.</p>
        </div>

        <div class="space-y-3">
            <div class="flex items-center">
                <input type="checkbox" id="overwrite" name="overwrite" class="transform scale-125 mr-3">
                <label for="overwrite" class="text-sm font-medium text-gray-600">
                    Overwrite existing file if it exists
                </label>
            </div>

            <div class="flex items-center">
                <input type="checkbox" id="create_backup" name="create_backup" checked class="transform scale-125 mr-3">
                <label for="create_backup" class="text-sm font-medium text-gray-600">
                    Create backup of existing file before overwriting
                </label>
            </div>
        </div>

        <div class="flex gap-4 pt-4">
            <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-6 rounded">
                Restore File
            </button>
            <a href="/files" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Auto-expand input field for long paths
    document.addEventListener('DOMContentLoaded', function () {
        const pathInput = document.getElementById('restore_path');
        if (pathInput) {
            // Set minimum width based on content
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            context.font = '14px monospace';
            const textWidth = context.measureText(pathInput.value).width;

            if (textWidth > pathInput.offsetWidth) {
                pathInput.style.fontSize = '12px';
            }

            // Add event listener to show full path on focus
            pathInput.addEventListener('focus', function () {
                this.select();
            });
        }
    });
</script>
{% endblock %}